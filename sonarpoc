pipeline{
    agent {label 'sonar'}
    stages{
       /*stage('Git Checkout Stage'){
            steps{
                git branch: 'main', url: 'https://github.com/tranju664/Sonar-Qube-war-example.git'
            }
         }*/       
       stage('Build Stage'){
            steps{
                sh 'mvn clean install'
            }
         }
       stage('Build & SonarQube Analysis') {
         def mvn = tool 'maven'
         withSonarQubeEnv('SonarQube') {
         sh """
            ${mvn}/bin/mvn clean verify \
            org.sonarsource.scanner.maven:sonar-maven-plugin:sonar \
            -Dsonar.projectKey=sonardemo \
            -Dsonar.projectName=sonardemo
         """
        }
    }
  }
